\documentclass[11pt]{article}

\usepackage[parfill]{parskip}

\setlength{\topmargin}{-.5in}
\setlength{\textheight}{9in}
\setlength{\oddsidemargin}{.125in}
\setlength{\textwidth}{6.25in}

\newcommand {\cmd}[1] {\begin{quote}#1\end{quote}}

\begin{document}
\title{Open Genomics Engine - Command Documentation}
\author{Lee Baker\\
Virginia Bioinformatics Instutute\\
lee@leecbaker.com}
\maketitle

\section {Introduction}
\section {Commands}
OpenGE consists of a collection of operations that can be invoked using the 
OpenGE should be called with the following syntax:

\cmd{openge \textit{command [options]}}

where command is one of the commands listed in the following table, and options are various flags and parameters that may be supplied depending on the command:

\begin{center}
\begin{tabular}{lp{3.5in}}
\hline
Command&Description\\ \hline
convert&Convert a SAM file to a BAM file\\
count&Count reads in a BAM file\\
dedup&Mark duplicates\\
head&Create a BAM file with the first \textit{n} reads of another BAM file\\
help&Get help for any OpenGE command\\
mergesort&Merges and sorts multiple bamfiles\\
\end{tabular}
\end{center}

\subsection {General}
The following flags are common between for all commands. Additional flags and parameters are available for individual commands, depending on the command.
\begin{center}
\begin{tabular}{llp{3.5in}}
\hline
Flag&Long flag&Description\\ \hline
-i \textit{filename}&{-}{-}in \textit{filename}&Input filename. Input files can also be specified without this flag. Optional.\\
-o \textit{filename}&{-}{-}out \textit{filename}&Output filename. Defaults to stdout if omitted. \\
-v&{-}{-}verbose&Display additional information to stderr while processing, including progress indicators and informational messages. Optional.\\
-t&{-}{-}threads&Select the number of threads to be used when doing parallel processing. Optional.\\
-d&{-}{-}nothreads&Disable multithreaded processing.\\
\end{tabular}
\end{center}

When input or output files are required, stdin or stdout may be used by simply omitting the input filename or output filename. For instance, the following command:

\cmd{openge mergesort}

by itself will read a BAM file from command line, process it, and print the results to stdout. This enables commands to be chained together. For instance:

\cmd{openge convert in.sam $|$ openge count}

will count the number of lines in a SAM file. Console redirection can be used as well. The following two commands are equivalent in a bash shell:

\cmd{openge mergesort a.bam -o c.bam}
\cmd{openge mergesort $<$ a.bam $>$ c.bam}

\subsection {convert}
Converts a SAM file to a BAM file.

Example:
\cmd{openge convert in.sam -o out.bam}
\subsection {count}
The count command returns the number of reads contained in one or more BAM files. No parameters (other than input files) are required.

Example:
\cmd{openge count a.bam}
\cmd{openge count b.bam c.bam d.bam}

\subsection {dedup}
To be completed at a later date.

\subsection {head}
A single bamfile is generated from the first \textit{n} reads in the provided file. The header information saved is the same as in the input file.

For example,
\cmd{openge head -o output.bam infile.bam -n 500}
generates a BAM file called output.bam that contains the header and the first 500 reads contained in infile.bam.

Parameters:
\begin{center}
\begin{tabular}{llp{3.5in}}
\hline
Flag&Long flag&Description\\ \hline
-n&--n&Number of reads to include in the generated file\\
\end{tabular}
\end{center}

\subsection {help}
The help command shows available options for any available command. 

\cmd{openge help \textit{[command]}}

For example:

\cmd{openge help mergesort}

\cmd{openge help count}

Available commands can be seen in the table at the top of this section.


\subsection {mergesort}
This command generates a single bamfile from one or more input files. The supplied input files are merged and then sorted by read position or region.

Parameters:
\begin{center}
\begin{tabular}{llp{3.5in}}
\hline
Flag&Long flag&Description\\ \hline
-c \textit{level}&{-}{-}compression \textit{level}&Compression level- defaults to 6. Valid levels are 0-9, and correspond to zlib's deflate compression levels. \\
-r \textit{region}&{-}{-}region \textit{region}&Genomic region to use\\
-n \textit{alignments}&{-}{-}n \textit{alignments}&Number of alignments to use per temporary file. Defaults to 500,000.\\
-C&{-}{-}compresstempfiles&Compress temp files. By default, temporary files are uncompressed.\\
\end{tabular}
\end{center}

The number of alignments per temporary file has a large effect on speed when processing large datasets. Adjusting the number of alignments upwards produces larger (and fewer) temporary files at the expense of memory, but reduces the processing time.

\section {License}
\copyright 2012 Virginia Bioinformatics Institute. All rights reserved.

Note: License may change at a future date.
\end{document}